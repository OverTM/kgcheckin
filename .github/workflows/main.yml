name: main
on:
  workflow_dispatch:
  # push:
  schedule:
    - cron: '2 16 * * *'
jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - name: 检出仓库
        uses: actions/checkout@v3
      - name: 创建node
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'
          cache-dependency-path: ./api/package-lock.json
      - name: Cache node_modules in api directory
        id: cache-npm
        uses: actions/cache@v3
        with:
          path: ./api/node_modules
          key: ${{ runner.os }}-node-${{ hashFiles('./api/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-
      - name: 安装依赖
        run: npm run install
        if: ${{ steps.cache-npm.outputs.cache-hit != 'true' }}
      - name: 签到
        run: npm run main
        env:
          USERINFO: ${{ secrets.USERINFO }}
          USERINFO1: ${{ secrets.USERINFO1 }}
          USERINFO2: ${{ secrets.USERINFO2 }}
          USERINFO3: ${{ secrets.USERINFO3 }}
          USERINFO4: ${{ secrets.USERINFO4 }}
          USERINFO5: ${{ secrets.USERINFO5 }}
          USERINFO6: ${{ secrets.USERINFO6 }}
          USERINFO7: ${{ secrets.USERINFO7 }}
          USERINFO8: ${{ secrets.USERINFO8 }}
          USERINFO9: ${{ secrets.USERINFO9 }}
          USERINFO10: ${{ secrets.USERINFO10 }}
          USERINFO11: ${{ secrets.USERINFO11 }}
          USERINFO12: ${{ secrets.USERINFO12 }}
          USERINFO13: ${{ secrets.USERINFO13 }}
          USERINFO14: ${{ secrets.USERINFO14 }}
          USERINFO15: ${{ secrets.USERINFO15 }}
          USERINFO16: ${{ secrets.USERINFO16 }}
          USERINFO17: ${{ secrets.USERINFO17 }}
          USERINFO18: ${{ secrets.USERINFO18 }}
          USERINFO19: ${{ secrets.USERINFO19 }}
          USERINFO20: ${{ secrets.USERINFO20 }}

